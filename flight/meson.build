c_src = [
  'libraries/CoordinateConversions.c',
  'libraries/alarms.c',
  'libraries/fifo_buffer.c',
  'libraries/instrumentation.c',
  'libraries/math/butterworth.c',
  'libraries/math/mathmisc.c',
  'libraries/math/pid.c',
  'libraries/math/sin_lookup.c',
  'libraries/notification.c',
  'libraries/optypes.c',
  'libraries/printf-stdarg.c',
  'libraries/sanitycheck.c',
  'modules/Actuator/actuator.c',
  'modules/Attitude/attitude.c',
  'modules/CameraStab/camerastab.c',
  'modules/ComUsbBridge/ComUsbBridge.c',
  'modules/FirmwareIAP/firmwareiap.c',
  'modules/GPS/DJI.c',
  'modules/GPS/GPS.c',
  'modules/GPS/NMEA.c',
  'modules/GPS/UBX.c',
  'modules/GPS/ubx_autoconfig.c',
  'modules/ManualControl/armhandler.c',
  'modules/ManualControl/manualcontrol.c',
  'modules/ManualControl/manualhandler.c',
  'modules/ManualControl/pathfollowerhandler.c',
  'modules/ManualControl/pathplannerhandler.c',
  'modules/ManualControl/stabilizedhandler.c',
  'modules/ManualControl/takeofflocationhandler.c',
  'modules/Osd/osdoutput/osdoutput.c',
  'modules/Receiver/receiver.c',
  'modules/Stabilization/cruisecontrol.c',
  'modules/Stabilization/innerloop.c',
  'modules/Stabilization/outerloop.c',
  'modules/Stabilization/stabilization.c',
  'modules/Stabilization/virtualflybar.c',
  'modules/System/systemmod.c',
  'modules/Telemetry/telemetry.c',
  'modules/TxPID/txpid.c',
  'modules/UAVOMSPBridge/UAVOMSPBridge.c',
  'modules/UAVOMavlinkBridge/UAVOMavlinkBridge.c',
  # 'pios/common/libraries/FreeRTOS/Source/croutine.c',
  # 'pios/common/libraries/FreeRTOS/Source/event_groups.c',
  # 'pios/common/libraries/FreeRTOS/Source/list.c',
  # 'pios/common/libraries/FreeRTOS/Source/openocd.c',
  # 'pios/common/libraries/FreeRTOS/Source/portable/GCC/ARM_CM3/port.c',
  # 'pios/common/libraries/FreeRTOS/Source/portable/MemMang/heap_1.c',
  # 'pios/common/libraries/FreeRTOS/Source/queue.c',
  # 'pios/common/libraries/FreeRTOS/Source/tasks.c',
  # 'pios/common/libraries/FreeRTOS/Source/timers.c',
  'pios/common/pios_adxl345.c',
  'pios/common/pios_bma180.c',
  'pios/common/pios_bmp085.c',
  'pios/common/pios_bmp280.c',
  'pios/common/pios_board_io.c',
  'pios/common/pios_board_sensors.c',
  'pios/common/pios_callbackscheduler.c',
  'pios/common/pios_com.c',
  'pios/common/pios_com_msg.c',
  'pios/common/pios_crc.c',
  'pios/common/pios_debuglog.c',
  'pios/common/pios_deltatime.c',
  'pios/common/pios_dsm.c',
  'pios/common/pios_etasv3.c',
  'pios/common/pios_exbus.c',
  'pios/common/pios_flash_jedec.c',
  'pios/common/pios_flashfs_logfs.c',
  'pios/common/pios_gcsrcvr.c',
  'pios/common/pios_hcsr04.c',
  'pios/common/pios_hmc5843.c',
  'pios/common/pios_hmc5x83.c',
  'pios/common/pios_hott.c',
  'pios/common/pios_i2c_esc.c',
  'pios/common/pios_iap.c',
  'pios/common/pios_ibus.c',
  'pios/common/pios_instrumentation.c',
  'pios/common/pios_l3gd20.c',
  'pios/common/pios_led.c',
  'pios/common/pios_mem.c',
  'pios/common/pios_mpu6000.c',
  'pios/common/pios_mpu9250.c',
  'pios/common/pios_mpxv.c',
  'pios/common/pios_ms4525do.c',
  'pios/common/pios_ms56xx.c',
  'pios/common/pios_notify.c',
  'pios/common/pios_openlrs.c',
  'pios/common/pios_openlrs_rcvr.c',
  'pios/common/pios_oplinkrcvr.c',
  'pios/common/pios_rcvr.c',
  'pios/common/pios_rfm22b.c',
  'pios/common/pios_rfm22b_com.c',
  'pios/common/pios_sbus.c',
  'pios/common/pios_sdcard.c',
  'pios/common/pios_semaphore.c',
  'pios/common/pios_sensors.c',
  'pios/common/pios_servo.c',
  'pios/common/pios_srxl.c',
  'pios/common/pios_task_monitor.c',
  'pios/common/pios_thread.c',
  'pios/common/pios_usb_desc_hid_cdc.c',
  'pios/common/pios_usb_desc_hid_only.c',
  'pios/common/pios_usb_util.c',
  'pios/common/pios_video.c',
  'pios/common/pios_wavplay.c',
  'pios/stm32f10x/libraries/CMSIS/Core/CM3/system_stm32f10x.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/misc.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_adc.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_bkp.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_can.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_cec.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_crc.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_dac.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_dbgmcu.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_dma.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_exti.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_flash.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_fsmc.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_gpio.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_i2c.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_iwdg.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_pwr.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_rcc.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_rtc.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_sdio.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_spi.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_tim.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_usart.c',
  'pios/stm32f10x/libraries/STM32F10x_StdPeriph_Driver/src/stm32f10x_wwdg.c',
  'pios/stm32f10x/libraries/STM32_USB-FS-Device_Driver/src/usb_core.c',
  'pios/stm32f10x/libraries/STM32_USB-FS-Device_Driver/src/usb_init.c',
  'pios/stm32f10x/libraries/STM32_USB-FS-Device_Driver/src/usb_int.c',
  'pios/stm32f10x/libraries/STM32_USB-FS-Device_Driver/src/usb_mem.c',
  'pios/stm32f10x/libraries/STM32_USB-FS-Device_Driver/src/usb_regs.c',
  'pios/stm32f10x/libraries/STM32_USB-FS-Device_Driver/src/usb_sil.c',
  'pios/stm32f10x/pios_adc.c',
  'pios/stm32f10x/pios_bkp.c',
  'pios/stm32f10x/pios_bl_helper.c',
  'pios/stm32f10x/pios_debug.c',
  'pios/stm32f10x/pios_delay.c',
  'pios/stm32f10x/pios_eeprom.c',
  'pios/stm32f10x/pios_exti.c',
  'pios/stm32f10x/pios_flash_internal.c',
  'pios/stm32f10x/pios_gpio.c',
  'pios/stm32f10x/pios_i2c.c',
  'pios/stm32f10x/pios_irq.c',
  'pios/stm32f10x/pios_ppm.c',
  'pios/stm32f10x/pios_ppm_out.c',
  'pios/stm32f10x/pios_pwm.c',
  'pios/stm32f10x/pios_rtc.c',
  'pios/stm32f10x/pios_spi.c',
  'pios/stm32f10x/pios_sys.c',
  'pios/stm32f10x/pios_tim.c',
  'pios/stm32f10x/pios_usart.c',
  'pios/stm32f10x/pios_usb.c',
  'pios/stm32f10x/pios_usb_cdc.c',
  'pios/stm32f10x/pios_usb_hid.c',
  'pios/stm32f10x/pios_usb_hid_istr.c',
  'pios/stm32f10x/pios_usb_hid_pwr.c',
  'pios/stm32f10x/pios_usb_rctx.c',
  'pios/stm32f10x/pios_usbhook.c',
  'pios/stm32f10x/pios_wdg.c',
  # 'pios/stm32f10x/startup_stm32f10x_MD_CC.S',
  'pios/common/pios_board_info.c',
  'targets/boards/coptercontrol/firmware/coptercontrol.c',
  'targets/boards/coptercontrol/firmware/pios_board.c',
  'targets/boards/coptercontrol/pios_usb_board_data.c',
  'uavobjects/eventdispatcher.c',
  'uavobjects/uavobjectmanager.c',
  'uavobjects/uavobjectpersistence.c',
  'uavtalk/uavtalk.c',
]

# librepilot_startup_stm32f10x_md = files(meson.current_source_dir() / 'pios/stm32f10x/startup_stm32f10x_MD_CC.S')
#
# librepilot_stm_link_files = files(meson.current_source_dir() / 'pios/stm32f10x//link_STM32103CB_CC_Rev1_memory.ld',
#                                   meson.current_source_dir() / 'pios/stm32f10x//link_STM32103CB_CC_Rev1_sections.ld')

foreach file : c_src
  librepilot_targets += librepilot_compile.process(file)
  librepilot_mock_targets += librepilot_mock_compile.process(file)
endforeach
